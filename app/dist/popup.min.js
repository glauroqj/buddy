!function(t){function e(a){if(o[a])return o[a].exports;var s=o[a]={i:a,l:!1,exports:{}};return t[a].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var o={};e.m=t,e.c=o,e.d=function(t,o,a){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e){!function(){var t={apiKey:"AIzaSyCmL6EppiFzE8BrY_xMRV0k4VG_NtJ6IWU",authDomain:"buddy-339dc.firebaseapp.com",databaseURL:"https://buddy-339dc.firebaseio.com",projectId:"buddy-339dc",storageBucket:"buddy-339dc.appspot.com",messagingSenderId:"799103313911"};firebase.initializeApp(t),new Vue({name:"Buddy",el:"#buddy",data:{user:{},title:"",firstLogin:!0,weekend:!1,vote:!1,voted:{},errorForm:!1,company:"Sympla",name:"",sector:"",lastVote:"",loading:!1,gif:[],keyDay:"",someoneVote:"",message:!1},watch:{},mounted:function(){var t=this;setInterval(function(){t.user=JSON.parse(localStorage.getItem("Buddy-Login")),""===t.user||null===t.user||void 0===t.user?t.firstLogin=!0:(t.firstLogin=!1,t.user=JSON.parse(localStorage.getItem("Buddy-Login")),t.title=t.user.name),t.voted=localStorage.getItem("Buddy-Vote"),""===t.voted||null===t.voted||void 0===t.voted?t.vote=!1:t.vote=!0},1e3);var e=moment().format("dddd");if("Saturday"==e||"Sunday"==e||"s√°bado"==e||"domingo"==e){$.ajax({url:"https://api.giphy.com/v1/gifs/random?api_key=xmSEm4iAty6mMRGFUm4k3bErZeqmYi1w&tag=happy&rating=G",method:"GET",dataType:"json"}).done(function(e){t.gif=e.data,chrome.browserAction.setIcon({path:"../images/buddy-20x20.png"})}).fail(function(t){console.log("error",t)}),t.weekend=!0}else t.weekend=!1;this.lastVote=JSON.parse(localStorage.getItem("Buddy-Last-Vote")),null!=this.lastVote&&void 0!=this.lastVote||(this.lastVote=0),moment().format("DD/MM/YYYY")!=this.lastVote.day&&localStorage.removeItem("Buddy-Vote"),this.user=JSON.parse(localStorage.getItem("Buddy-Login")),""===this.user||null===this.user||void 0===this.user?this.firstLogin=!0:(this.firstLogin=!1,this.user=JSON.parse(localStorage.getItem("Buddy-Login")),this.title=this.user.name),this.voted=localStorage.getItem("Buddy-Vote"),""===this.voted||null===this.voted||void 0===this.voted?(this.vote=!1,this.getCustomMessage()):this.vote=!0},methods:{reset:function(){this.vote=!1,this.firstLogin=!0,this.errorForm=!1},login:function(){var t={company:this.company,name:this.name,sector:this.sector};if(""!=this.sector)return localStorage.setItem("Buddy-Login",JSON.stringify(t)),this.firstLogin=!1,this.user=JSON.parse(localStorage.getItem("Buddy-Login")),void(this.title=this.user.name);this.errorForm=!0},send:function(e){var o=this;this.vote=!0,this.loading=!0,moment().locale("pt-br");var a=moment().format("DD"),s=(moment().format("DD/MM/YYYY"),moment().format("MMMM")),n=moment().format("YYYY"),r=t.databaseURL+"/"+o.user.sector+"/"+n+"/"+s+"/"+a+".json";$.ajax({url:r,method:"GET",dataType:"json"}).done(function(t){if(null!=t)return o.keyDay=Object.keys(t),o.someoneVote=t[o.keyDay],o.updateDataWithKeyDay(o.keyDay,e),console.log("Key day: "+o.keyDay),void(o.message="");o.createFirstKeyDay(e),console.log("Key day: "+o.keyDay)}).fail(function(t){console.log("Error Key day: ",t)})},createFirstKeyDay:function(e){var o=this;moment().locale("pt-br");var a=moment().format("DD"),s=moment().format("DD/MM/YYYY"),n=moment().format("MMMM"),r=moment().format("YYYY"),i=t.databaseURL+"/"+o.user.sector+"/"+r+"/"+n+"/"+a+".json",d={vote:e,month:n,date:s,quantVotes:1,mediaVotes:e},m={day:s};$.ajax({url:i,method:"POST",dataType:"json",data:JSON.stringify(d)}).done(function(t){console.log("success",t),localStorage.setItem("Buddy-Vote",JSON.stringify(d)),localStorage.setItem("Buddy-Last-Vote",JSON.stringify(m)),o.lastVote=JSON.parse(localStorage.getItem("Buddy-Last-Vote")),chrome.browserAction.setIcon({path:"../images/buddy-20x20.png"}),setTimeout(function(){o.loading=!1},800)}).fail(function(t){console.log("error",t),setTimeout(function(){o.loading=!1},800)})},updateDataWithKeyDay:function(e,o){var a=this;moment().locale("pt-br");var s=moment().format("DD"),n=moment().format("DD/MM/YYYY"),r=moment().format("MMMM"),i=moment().format("YYYY"),d=t.databaseURL+"/"+a.user.sector+"/"+i+"/"+r+"/"+s+"/"+[e]+".json",m=0,u=0,l=0;m=parseInt(a.someoneVote.vote)+o,l=parseInt(a.someoneVote.quantVotes)+1,u=(m/l).toFixed(2);var c={vote:m,quantVotes:l,mediaVotes:u},g={day:n};$.ajax({url:d,method:"PATCH",dataType:"json",data:JSON.stringify(c)}).done(function(t){console.log("success",t),localStorage.setItem("Buddy-Vote",JSON.stringify(c)),localStorage.setItem("Buddy-Last-Vote",JSON.stringify(g)),a.lastVote=JSON.parse(localStorage.getItem("Buddy-Last-Vote")),chrome.browserAction.setIcon({path:"../images/buddy-20x20.png"}),setTimeout(function(){a.loading=!1},800)}).fail(function(t){console.log("error",t),setTimeout(function(){a.loading=!1},800)})},getCustomMessage:function(){var e=this;console.log("get message");var o=t.databaseURL+"/customMessage.json";console.log(o),$.ajax({url:o,method:"GET",dataType:"json"}).done(function(t){e.message=t[Object.keys(t)]}).fail(function(t){console.log("error",t)})}}})}()}]);